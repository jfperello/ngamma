/*SFPAnalyzer.h
 *Class designed to analyze coincidence events. Currently only implemented for focal plane
 *data. Additional changes for SABRE would include this file and the sructure ProcessedEvent
 *in DataStructs.h. Based on code written by S. Balak, K. Macon, and E. Good.
 *
 *Gordon M. Oct. 2019
 *
 *Refurbished and updated Jan 2020 by GWM. Now uses both focal plane and SABRE data
 */
#ifndef SFPANALYZER_H
#define SFPANALYZER_H

#include "DataStructs.h"
#include "FP_kinematics.h"

using namespace std;

class SFPAnalyzer {

  public:
    SFPAnalyzer();
    ~SFPAnalyzer();
    ProcessedEvent GetProcessedEvent(CoincEvent& event);
    inline void ClearHashTable() { rootObj->Clear(); };
    inline THashTable* GetHashTable() { return rootObj; };
    Double_t ADC(double x, int i);
    Double_t TOF(double x, int j, int m);
    double Bins = 311;
    double tEdges[312] = { 0, 0.9, 0.92, 0.94, 0.96, 0.98, 1, 1.02, 1.04, 1.06, 1.08, 1.1, 1.12, 1.14, 1.16, 1.18, 1.2, 1.22, 1.24, 1.26, 1.28, 1.3, 1.32, 1.34, 1.36, 1.38, 1.4, 1.42, 1.44, 1.46, 1.48, 1.5, 1.52, 1.54, 1.56, 1.58, 1.6, 1.62, 1.64, 1.66, 1.68, 1.7, 1.72, 1.74, 1.76, 1.78, 1.8, 1.82, 1.84, 1.86, 1.88, 1.9, 1.92, 1.94, 1.96, 1.98, 2, 2.025, 2.05, 2.075, 2.1, 2.125, 2.15, 2.175, 2.2, 2.225, 2.25, 2.275, 2.3, 2.325, 2.35, 2.375, 2.4, 2.425, 2.45, 2.475, 2.5, 2.53, 2.56, 2.59, 2.62, 2.65, 2.68, 2.71, 2.74, 2.77, 2.8, 2.83, 2.86, 2.89, 2.92, 2.95, 2.98, 3.01, 3.04, 3.07, 3.1, 3.13, 3.16, 3.19, 3.22, 3.25, 3.28, 3.31, 3.34, 3.37, 3.4, 3.43, 3.46, 3.49, 3.52, 3.55, 3.58, 3.61, 3.64, 3.67, 3.7, 3.735, 3.77, 3.805, 3.84, 3.875, 3.91, 3.945, 3.98, 4.015, 4.05, 4.085, 4.12, 4.155, 4.19, 4.225, 4.26, 4.295, 4.33, 4.365, 4.4, 4.44, 4.48, 4.52, 4.56, 4.6, 4.64, 4.68, 4.72, 4.76, 4.8, 4.84, 4.88, 4.92, 4.96, 5, 5.04, 5.08, 5.12, 5.16, 5.2, 5.24, 5.28, 5.32, 5.36, 5.4, 5.44, 5.48, 5.52, 5.56, 5.6, 5.64, 5.68, 5.72, 5.76, 5.8, 5.84, 5.88, 5.92, 5.96, 6, 6.04, 6.08, 6.12, 6.16, 6.2, 6.24, 6.28, 6.32, 6.36, 6.4, 6.44, 6.48, 6.52, 6.56, 6.6, 6.64, 6.68, 6.72, 6.76, 6.8, 6.84, 6.88, 6.92, 6.96, 7, 7.04, 7.08, 7.12, 7.16, 7.2, 7.24, 7.28, 7.32, 7.36, 7.4, 7.44, 7.48, 7.52, 7.56, 7.6, 7.64, 7.68, 7.72, 7.76, 7.8, 7.84, 7.88, 7.92, 7.96, 8, 8.04, 8.08, 8.12, 8.16, 8.2, 8.24, 8.28, 8.32, 8.36, 8.4, 8.44, 8.48, 8.52, 8.56, 8.6, 8.64, 8.68, 8.72, 8.76, 8.8, 8.84, 8.88, 8.92, 8.96, 9, 9.04, 9.08, 9.12, 9.16, 9.2, 9.24, 9.28, 9.32, 9.36, 9.4, 9.44, 9.48, 9.52, 9.56, 9.6, 9.64, 9.68, 9.72, 9.76, 9.8, 9.84, 9.88, 9.92, 9.96, 10, 10.04, 10.08, 10.12, 10.16, 10.2, 10.24, 10.28, 10.32, 10.36, 10.4, 10.44, 10.48, 10.52, 10.56, 10.6, 10.64, 10.68, 10.72, 10.76, 10.8, 10.84, 10.88, 10.92, 10.96, 11, 11.04, 11.08, 11.12, 11.16, 11.2, 11.24, 11.28, 11.32, 11.36, 11.4 };
    double eEdges[312] = { -8.72,-8.7, -8.68, -8.66, -8.64, -8.62, -8.6, -8.58, -8.56, -8.54, -8.52, -8.5, -8.48, -8.46, -8.44, -8.42, -8.4, -8.38, -8.36, -8.34, -8.32, -8.3, -8.28, -8.26, -8.24, -8.22, -8.2, -8.18, -8.16, -8.14, -8.12, -8.1, -8.08, -8.06, -8.04, -8.02, -8, -7.98, -7.96, -7.94, -7.92, -7.9, -7.88, -7.86, -7.84, -7.82, -7.8, -7.78, -7.76, -7.74, -7.72, -7.7, -7.68, -7.66, -7.64, -7.62, -7.6, -7.575, -7.55, -7.525, -7.5, -7.475, -7.45, -7.425, -7.4, -7.375, -7.35, -7.325, -7.3, -7.275, -7.25, -7.225, -7.2, -7.175, -7.15, -7.125, -7.1, -7.07, -7.04, -7.01, -6.98, -6.95, -6.92, -6.89, -6.86, -6.83, -6.8, -6.77, -6.74, -6.71, -6.68, -6.65, -6.62, -6.59, -6.56, -6.53, -6.5, -6.47, -6.44, -6.41, -6.38, -6.35, -6.32, -6.29, -6.26, -6.23, -6.2, -6.17, -6.14, -6.11, -6.08, -6.05, -6.02, -5.99, -5.96, -5.93, -5.9, -5.865, -5.83, -5.795, -5.76, -5.725, -5.69, -5.655, -5.62, -5.585, -5.55, -5.515, -5.48, -5.445, -5.41, -5.375, -5.34, -5.305, -5.27, -5.235, -5.2, -5.16, -5.12, -5.08, -5.04, -5, -4.96, -4.92, -4.88, -4.84, -4.8, -4.76, -4.72, -4.68, -4.64, -4.6, -4.56, -4.52, -4.48, -4.44, -4.4, -4.36, -4.32, -4.28, -4.24, -4.2, -4.16, -4.12, -4.08, -4.04, -4, -3.96, -3.92, -3.88, -3.84, -3.8, -3.76, -3.72, -3.68, -3.64, -3.6, -3.56, -3.52, -3.48, -3.44, -3.4, -3.36, -3.32, -3.28, -3.24, -3.2, -3.16, -3.12, -3.08, -3.04, -3, -2.96, -2.92, -2.88, -2.84, -2.8, -2.76, -2.72, -2.68, -2.64, -2.6, -2.56, -2.52, -2.48, -2.44, -2.4, -2.36, -2.32, -2.28, -2.24, -2.2, -2.16, -2.12, -2.08, -2.04, -2, -1.96, -1.92, -1.88, -1.84, -1.8, -1.76, -1.72, -1.68, -1.64, -1.6, -1.56, -1.52, -1.48, -1.44, -1.4, -1.36, -1.32, -1.28, -1.24, -1.2, -1.16, -1.12, -1.08, -1.04, -1, -0.96, -0.92, -0.88, -0.84, -0.8, -0.76, -0.72, -0.68, -0.64, -0.6, -0.56, -0.52, -0.48, -0.44, -0.4, -0.36, -0.32, -0.28, -0.24, -0.2, -0.16, -0.12, -0.08, -0.04, -2.45102E-11, 0.04, 0.08, 0.12, 0.16, 0.2, 0.24, 0.28, 0.32, 0.36, 0.4, 0.44, 0.48, 0.52, 0.56, 0.6, 0.64, 0.68, 0.72, 0.76, 0.8, 0.84, 0.88, 0.92, 0.96, 1, 1.04, 1.08, 1.12, 1.16, 1.2, 1.24, 1.28, 1.32, 1.36, 1.4, 1.44, 1.48, 1.52, 1.56, 1.6, 1.64, 1.68, 1.72, 1.76, 1.8 };

  private:
    void Reset(); //Sets ouput structure back to "zero"
    void AnalyzeEvent(CoincEvent& event);

    /*Fill wrappers for use with THashTable*/
    void MyFill(string name, int binsx, double minx, double maxx, double valuex, int binsy, double miny, double maxy, double valuey);
    void MyFill(string name, int binsx, double minx, double maxx, double valuex, double valuey, int i);
    void MyFill(string name, int binsx, double minx, double maxx, double valuex);
    void MyFill(string name, double valuex, int i);

    CoincEvent *event_address; //Input branch address
    ProcessedEvent pevent, blank; //output branch and reset


    THashTable *rootObj; //root storage

};

#endif
